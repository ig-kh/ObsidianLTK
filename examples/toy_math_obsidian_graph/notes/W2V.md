---
tags:
  - NLP
  - SYS/DEPRECATED
---
–ú–µ—Ç–æ–¥ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏  Word2Vector –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ö–æ–¥–µ –ø–æ —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –∫–æ—Ä–ø—É—Å—É —Å–∫–æ–ª—å–∑—è—â–∏–º –æ–∫–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å –≤—ã–∫–æ–ª–æ—Ç—ã–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º. –í—Å–µ —Å–ª–æ–≤–∞ (–∏–ª–∏ —Ç–æ–∫–µ–Ω—ã) –∏–º–µ—é—Ç –≤ –º–æ–¥–µ–ª–∏ –ø–æ –¥–≤–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏—Ö –∏—Ö –≤–µ–∫—Ç–æ—Ä–∞, –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–æ—Å—Ç–∞–≤–Ω–æ–π *v* —á–∞—Å—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ —Å–ª–æ–≤–∞ —Å –≤–µ–∫—Ç–æ—Ä–æ–º *u*.
___
$\mathbb{W}$ -–∑–¥–µ—Å—å –∏ –¥–∞–ª–µ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å–µ—Ö —Å–ª–æ–≤-—Ç–æ–∫–µ–Ω–æ–≤
$\mathbb{U}$ -–∑–¥–µ—Å—å –∏ –¥–∞–ª–µ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤, –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å —Ä–æ–ª—å—é —Ç–æ–∫–µ–Ω–∞ –∫–∞–∫ –≥–ª–∞–≤–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º
$\mathbb{V}$ -–∑–¥–µ—Å—å –∏ –¥–∞–ª–µ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤, –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å —Ä–æ–ª—å—é —Ç–æ–∫–µ–Ω–∞ –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º
___
–ê–ª–≥–æ—Ä–∏—Ç–º –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç —Å–∫–æ—Ä—ã –∫–∞–∫ dotproduct —Å–ª–æ–≤–∞ –∏–∑ *u* –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ –∏–∑ *v*, –∑–∞–¥–∞—á–µ–π –æ–±—É—á–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–∑ –æ–∫–Ω–∞ –∏–ª–∏ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

–û–±—É—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å NLLLoss.

### Skip-Gram
![[SG_w2v.png]]
–í skip-gram w2v –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ—Ö–æ–¥–∏—Ç –æ–∫–Ω–æ–º –∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å (–∏–∑ softmax) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∫–æ—Ä–æ–≤ –≤—ã–±–æ—Ä–∞ –≤–µ—Ä–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –∏ –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ *V*.
$$J = -\frac{1}{T}\sum^{T}_{t=1}\sum_{-m \geq j\geq m \text{ ; } j\neq0} \log \mathbb{p}(w_{t+j}|w_t), \mathbb{p}(w_{t+j}|w_t) \sim \frac{exp\bigg\{\big< u_{w_{t}};v_{w_{t+j}} \big>\bigg\}}{\sum_{w\in \mathbb{W}} exp\bigg\{\big< u_{w_{t}};v_w \big>\bigg\}}$$
üí°- –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–Ω—É—Ç—Ä–∏ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ –æ–∫–Ω–∞ –Ω–∞–±–∏—Ä–∞—Ç—å –ø–∞—Ä—ã —Å–ª–æ–≤ —Ü–µ–Ω—Ç—Ä-–∫–æ–Ω—Ç–µ–∫—Å—Ç, —Ç–æ –µ—Å—Ç—å –ø—Ä–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ –≤—Ö–æ–¥ –º–æ–¥–µ–ª—å - —Ç–æ–∫–µ–Ω —Ü–µ–Ω—Ç—Ä–∞, —Ä–∞–∑–º–µ—Ç–∫–∞ - —Ç–æ–∫–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
### CBOW

![[CBOW_w2v.png]]
–í CBOW —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ w2v –º–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –æ–∫–Ω–∞ (–∞–≥—Ä–µ–≥–∞—Ç —Å—É–º–º–∞ –≤–µ–∫—Ç–æ—Ä–æ–≤, —Ç.–µ. –º–µ—à–æ–∫ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤) –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ, —Ç–æ –µ—Å—Ç—å –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –≤–µ—Ä–Ω–æ–≥–æ *u*: $\bigg<\sum_{{-m \geq j\geq m \text{ ; } j\neq0}}u_{w_{t+j}}/(2m-1) \text{ ; } v_{w_t}\bigg>$
 $$J = -\frac{1}{T}\sum^{T}_{t=1} \log \mathbb{p}(w_{t}|w_{t-j} ... w_{t-1}, w_{t+1}... w_{t+j})$$$$ \mathbb{p}(w_{t}|w_{t-j} ... w_{t-1}, w_{t+1}... w_{t+j}) \sim \frac{exp\bigg\{\big< u_{w_{t}};\mathbb{E}_{w_c \in Context_j(w_t)}\big[v_{w_c} \big]\big>\bigg\}}{\sum_{w\in \mathbb{W}} exp\bigg\{\big< u_{w};\mathbb{E}_{w_c \in Context_j(w_t)}\big[v_{w_c} \big]\big>\bigg\}} $$
üí°- –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–Ω—É—Ç—Ä–∏ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ –æ–∫–Ω–∞ –Ω–∞–±–∏—Ä–∞—Ç—å –≤—Å–µ —Å–ª–æ–≤–∞, –∫—Ä–æ–º–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –≤–æ –≤—Ö–æ–¥, —Ç–æ –µ—Å—Ç—å –ø—Ä–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ –≤—Ö–æ–¥ –º–æ–¥–µ–ª–∏ - —Ç–æ–∫–µ–Ω—ã –≤—Å–µ—Ö —Å–ª–æ–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, —Ä–∞–∑–º–µ—Ç–∫–∞ - —Ç–æ–∫–µ–Ω —Ü–µ–Ω—Ç—Ä–∞

\* - —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç—ã SoftMax —Å–æ–∫—Ä–∞—â–∞—é—Ç—Å—è —Å –ª–æ–≥–∞—Ä–∏—Ñ–º–∞–º–∏ –∫ –≤–∏–¥—É: $-<u,v> + \sum exp{<u, v>}$
\*\* - –ø—Ä–∏ –ø–æ–º–æ—â–∏ [[k-Negative Sampling SoftMax|–Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–≥–æ —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏—è]] –∏–ª–∏ [[Hierarhical SoftMax|–±–∏–Ω–∞—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞]], —Å —É—á–µ—Ç–æ–º –±–æ–ª—å—à–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤, –º–æ–∂–Ω–æ —Å–∏–ª—å–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
___
### –°—Ö–æ–¥–∏–º–æ—Å—Ç—å –∫ SVD(PPMI)
–í –ø—Ä–µ–¥–µ–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞ –¥–ª—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π $d$ (e.g. 384) –≤–µ–∫—Ç–æ—Ä–∞ —Å–ª–æ–≤ —Å—Ö–æ–¥—è—Ç—Å—è –∫ –≤–µ–∫—Ç–æ—Ä–∞–º-—Å—Ç—Ä–æ–∫–∞–º –ª–µ–≤–æ–π [[SVD]] –º–∞—Ç—Ä–∏—Ü—ã [[Cound-based –º–µ—Ç–æ–¥—ã –≤–ª–æ–∂–µ–Ω–∏—è —Å–ª–æ–≤|PPMI]] –Ω–∞ —Ç–æ–º –∂–µ –∫–æ—Ä–ø—É—Å–µ c —Ä–∞–≤–Ω—ã–º $topk(eigenvals) = d$

