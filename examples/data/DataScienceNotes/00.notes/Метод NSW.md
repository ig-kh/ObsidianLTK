---
tags:
  - Graphs
  - Search
date: 2025-10-27
time: 22:24:09
location:
layer: bronze
---
Метод NSW решения [[Задача NNS - Nearest Neighbour Search|ANN]] полагается на предположение о том, что [[Тесный мир и свойство навигируемости|модель тесного мира]] хорошо описывает набор данных, так как в ней возможна низкая ошибка при применении жадного поиска в следствии свойства локальности.

### Стадия построения графа

Дано: множество данных $X = {x_1, x_2, \dots, x_n}$, параметр связности $k$ (максимальное число соседей для каждой вершины).
___
1. Инициализировать пустой граф $G = (V, E)$ с $V = \emptyset$, $E = \emptyset$.
2. Для каждой точки $q \in X$:
    1. Если $V = \emptyset$: добавить $q$ в $V$:
	    $V\leftarrow V\cap \{q\}$
    2. Иначе : выполнить жадный поиск по графу $G$ для нахождения множества $k$ ближайших соседей $\mathcal{N}(q) \subseteq V$ к точке $q$
	    - Добавить $q$ в $V$:
		    $V\leftarrow V\cap \{q\}$
	    - Соединить $q$ двунаправленно со всеми узлами в $\mathcal{N}(q)$: $E \leftarrow E \cup\{(q,v)\mid v\in\mathcal{N}(q)\}$
___

>Каждая вставка требует жадного поиска, который в среднем занимает $O(\log n)$ шагов (из-за малого [[Статистические показатели стандартных случайных графовых моделей|диаметра графа]]). Для $n$ вставок общая сложность — $O(n \log n)$. Граф имеет умеренный объём памяти: $O(n k)$ рёбер.

### Стадия поиска

Дано: запрос $q$, граф $G = (V, E)$.
___
1. Выбрать случайный стартовый узел $v_0 \in V$.
2. Установить текущий узел $v \leftarrow v_0$.
3. Повторять:
	Среди соседей $\mathcal{N}(v)$ найти: 
		$u^\star=\widetilde{arg⁡min}⁡_{u\in\mathcal{N}(v)}d(q,u)$
	Если $d(u^\star,q) < d(q,v)$:
		$v\leftarrow u^\star$
	Иначе завершить поиск и вернуть $u^\star$
___
$\Uparrow$ Из-за рандомизации стартовой вершины можно улучшить близость несколькими запусками из разных стартовых точек.
___
[[Иерархические обходы|Один уровень графа]] - компромисс между скоростью и точностью.
___
*Source:* [[Navigable-Small-Worlds_Graph-Based-NN-Search]]