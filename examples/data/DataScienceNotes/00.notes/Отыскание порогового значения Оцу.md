---
tags:
  - STATS
layer: bronze
---
Метод отыскания порогового значения Оцу применяется во многих алгоритмах, в частности в [[Otsu filter|Одноименном CV-фильтре]]. Имея распределение некоторого признака (напр. [[Otsu filter|яркость]] или [[Canny filter|углы градиента]]) алгоритм ищет пороговое значение, разделив гистограмму по которому будет достигнута минимальная дисперсия внутри классов, что сводимо к максимизации внеклассовой дисперсии.
# Бинарный случай
Метод опирается на предположение о бимодальном распределения признака, доказательство за авторством *Оцу* показывает, что можно рассмотреть задачу отыскания порога *t* как:

$t^* = argmin_t \bigg\{ \omega_1(t) \sigma_1^2(t) + \omega_2(t) \sigma_2^2(t) \bigg\}\equiv  argmax_t \bigg\{ \omega_1(t)\omega_2(t)\big[\mu_1(t) - \mu_2(t)\big]^2\bigg\}$
![[bin_otsu.png]]
# Случай со множеством классов
Возможно подобрать многие пороги эвристически после нахождения первого $t^*_1 := t^*$; тогда второй можно положить как $t^*_2 := t^*_1/k, k \in \mathbb{R}\setminus\{0\}$

Альтернативой является метод *мульти-Оцу*:
$\{t^*_1, ... , t^*_{k-1}\} = argmax_{\{t_1, ... , t_{k-1}\}} \bigg\{ \sum^k_{j=1}\omega_j\big[ \mu_j -M\big]^2\bigg\}$
$\omega_j=\sum_{i=t_j}^{t_{j+1}-1}p_i$
$\mu_j = \frac{\sum_{i\in Class_i} i \times p_i}{\omega_j}$
$M=\sum_i i \times p_i$
# Итог
*В общем, алгоритм можно описать как отыскание разделений мультимодального распределения на составляющие и сопоставление составляющих распределений классам. Кластеризация (здесь сегментация) - жесткая, вида четкой принадлежности:* $\hat{y}_l =\{ 0^0, ... 1^h, ..., 0^k\}, \sum \hat{y}_l =1$