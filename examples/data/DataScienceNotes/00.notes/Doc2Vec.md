---
tags:
  - NLP
date: 2025-10-27
time: 10:46:42
location:
layer: bronze
---
[[W2V]] в модификации [[W2V#CBOW|CBOW]] также имеет простейшее улучшение - механизм памяти.
![[Doc2Vector-PVDM.webp]]
Doc2Vec усовершенствует стандартный W2V добавляя документам доп. вектор - вектор самого документа, он эффективно носит ту информацию, которая отсутствует в каждом контекстном окне:

train:
На каждом шаге вектор документа добавляется в каждое окно в независимости от его локализации - так вектор документа обучается хранить информацию о всем документе в целом.

inference:
В downstream-сценарии для классификации или кластеризации самого документа вместо агрегата всех эмбеддингов текста используется вектор документа.
Если же нужно создать вектор для нового документа он обучается специфическим образом: вектора всех слов уже обучены, они замораживаются, а новый вектор случайно инициализируется - затем по всему тексту обучается CBOW, но обучается только вектор ново-добавленного документа.

Таким образом, вектор документа адаптируется существовать в векторном пространстве, порожденном моделью (так как вектора слов уже обучены и заморожены) и носить информацию о самом новом тексте (так как информацию все еще нужно дополнять). 
___

*Source*: 
- [medium](https://medium.com/wisio/a-gentle-introduction-to-doc2vec-db3e8c0cce5e)
- [[1405.4053v2.pdf]]